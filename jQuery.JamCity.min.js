/**
 *
 * jQuery.JamCity : v. 1.0
 * https://github.com/bluetidepro/jQuery.JamCity
 * Copyright (c) 2012 Zach Reed (Blue Tide Productions, LLC).
 * Dual licensed under the MIT and GPL licenses.  
 *
 * Also includes packed: hoverIntent r6 // 2011.02.26 // jQuery 1.5.1+ <http://cherne.net/brian/resources/jquery.hoverIntent.html> @author Brian Cherne brian(at)cherne(dot)net
 *
 */ (function(a){function b(b){a.fn.hoverIntent=function(b,c){var d={sensitivity:7,interval:100,timeout:0};d=a.extend(d,c?{over:b,out:c}:b);var e,f,g,h;var i=function(a){e=a.pageX;f=a.pageY};var j=function(b,c){c.hoverIntent_t=clearTimeout(c.hoverIntent_t);if(Math.abs(g-e)+Math.abs(h-f)<d.sensitivity){a(c).unbind("mousemove",i);c.hoverIntent_s=1;return d.over.apply(c,[b])}else{g=e;h=f;c.hoverIntent_t=setTimeout(function(){j(b,c)},d.interval)}};var k=function(a,b){b.hoverIntent_t=clearTimeout(b.hoverIntent_t);b.hoverIntent_s=0;return d.out.apply(b,[a])};var l=function(b){var c=jQuery.extend({},b);var e=this;if(e.hoverIntent_t){e.hoverIntent_t=clearTimeout(e.hoverIntent_t)}if(b.type=="mouseenter"){g=c.pageX;h=c.pageY;a(e).bind("mousemove",i);if(e.hoverIntent_s!=1){e.hoverIntent_t=setTimeout(function(){j(c,e)},d.interval)}}else{a(e).unbind("mousemove",i);if(e.hoverIntent_s==1){e.hoverIntent_t=setTimeout(function(){k(c,e)},d.timeout)}}};return this.bind("mouseenter",l).bind("mouseleave",l)};var b=b.find(".jmc_track a");b.each(function(){function m(){d.show().css({bottom:j-10+"px"}).animate({bottom:j,opacity:1},75)}function n(){a(".jmc_tooltip_wrap",this).animate({bottom:5*1.5+j,opacity:0},150,function(){a(this).hide()})}var b=a(this).attr("title");var c='<div class="jmc_tooltip_wrap">'+b+'<span class="jmc_tooltip_arrow_down"></span></div>';a(this).append(c);var d=a(".jmc_tooltip_wrap",this);var e=d.width();var f=d.outerWidth()/2+2;var g=d.height();var h=a(this).width();var i=a(this).height();var j=i;d.css({bottom:j+"px",marginLeft:"-"+f+"px"});d.css("opacity",0);var k=a(".jmc_tooltip_arrow_down",this);k.css({marginTop:g+8+"px",marginLeft:e/2+"px"});var l={sensitivity:1,interval:10,over:m,timeout:125,out:n};a(this).hoverIntent(l)})}function c(a){return(a+"").replace(/\0/g,"0").replace(/\\([\\'"])/g,"$1")}function d(a){if(typeof console=="object")console.log(a);else if(typeof opera=="object")opera.postError(a)}a.fn.JamCity=function(e){var f={apiKey:"",username:"",contentType:"",artSize:"",artQuality:"normal",number:5,tooltips:true,nowPlayingIcon:true,_blankLinks:true,noAlbumArtImg:"http://placehold.it/126x126&text=No Art",cssWrapperID:"jmc_wrap",cssThemeClass:"jmc_dark_theme",noLovedTracks:"Sorry, No loved tracks...",noTopAlbums:"Sorry, No top albums...",noTopTracks:"Sorry, No top tracks...",noNewReleases:"Sorry, No new releases...",noRecentTracks:"Sorry, No recent tracks...",onComplete:function(){}},g=a.extend({},f,e);if(g.apiKey==""){d("Please enter a valid API key.")}if(g.username==""){d("Please enter a valid username.")}if(g.contentType=="lovedTracks"||g.contentType=="lovedtracks"){var h="lovedTracks"}else if(g.contentType=="topAlbums"||g.contentType=="topalbums"){var h="topAlbums"}else if(g.contentType=="topTracks"||g.contentType=="toptracks"){var h="topTracks"}else if(g.contentType=="newReleases"||g.contentType=="newreleases"){var h="newReleases"}else if(g.contentType=="recentTracks"||g.contentType=="recenttracks"||g.contentType==""){var h="recentTracks"}if(h=="lovedTracks"){var i="http://ws.audioscrobbler.com/2.0/?method=user.getLovedTracks&user="+g.username+"&api_key="+g.apiKey+"&limit="+g.number+"&format=json&callback=?"}else if(h=="topAlbums"){var i="http://ws.audioscrobbler.com/2.0/?method=user.getTopAlbums&user="+g.username+"&api_key="+g.apiKey+"&format=json&callback=?"}else if(h=="topTracks"){var i="http://ws.audioscrobbler.com/2.0/?method=user.getTopTracks&user="+g.username+"&api_key="+g.apiKey+"&format=json&callback=?"}else if(h=="newReleases"){var i="http://ws.audioscrobbler.com/2.0/?method=user.getNewReleases&user="+g.username+"&api_key="+g.apiKey+"&format=json&callback=?"}else if(h=="recentTracks"){var i="http://ws.audioscrobbler.com/2.0/?method=user.getRecentTracks&user="+g.username+"&api_key="+g.apiKey+"&limit="+g.number+"&format=json&callback=?"}else{var i="http://ws.audioscrobbler.com/2.0/?method=user.getRecentTracks&user="+g.username+"&api_key="+g.apiKey+"&limit="+g.number+"&format=json&callback=?"}d(i);var j=a(this);if(g.artSize=="small"||g.artSize=="sm"){var k=0}else if(g.artSize=="medium"||g.artSize=="md"||g.artSize==""){var k=1}else if(g.artSize=="large"||g.artSize=="lg"){var k=2}j.append('<ul id="'+g.cssWrapperID+'" class="'+g.cssThemeClass+" jmc_size"+k+'"></ul>');var j=j.find("#"+g.cssWrapperID);a.getJSON(i,function(e){if(h=="lovedTracks"){if(e.lovedtracks.track){if(a.isArray(e.lovedtracks.track)){}else{e.lovedtracks.track=[e.lovedtracks.track]}a.each(e.lovedtracks.track,function(b,e){if(b>g.number-1)return false;var f=false;if(a(this).attr("error")){a(this).html("An error has occurred");d(a(this).attr("message"))}if(g.artQuality!=""&g.artQuality=="high"){k=2}else if(g.artQuality!=""&g.artQuality=="extreme"){k=3}if(e.image){f=true;var h=c(e.image[k]["#text"]);if(e.image[k]["#text"]==""){f=false}}var i=c(e.url);var l=e["name"].replace(/"/g,"");var m=e.artist["name"].replace(/"/g,"");j.append('<li class="jmc_track">'+'<a href="'+i+'" title="'+l+" by "+m+'"'+(g._blankLinks?'target="_blank"':'target="_self"')+">"+'<span class="jmc_album_art">'+'<img src="'+(f==true?h:g.noAlbumArtImg)+'" alt="'+l+" by "+m+'" />'+"</span>"+'<span class="jmc_vinyl_case"></span><span class="jmc_vinyl_slip"></span><span class="jmc_vinyl"></span>'+"</a>"+"</li>");if(b==g.number-1){g.onComplete.call(this)}});if(g.tooltips){var f=j;b(f)}}else{j.append('<span class="jmc_message">'+g.noLovedTracks+"</span>");d("No loved tracks...")}}else if(h=="topAlbums"){if(e.topalbums.album){if(a.isArray(e.topalbums.album)){}else{e.topalbums.album=[e.topalbums.album]}a.each(e.topalbums.album,function(b,e){if(b>g.number-1)return false;var f=false;if(a(this).attr("error")){a(this).html("An error has occurred");d(a(this).attr("message"))}if(g.artQuality!=""&g.artQuality=="high"){k=2}else if(g.artQuality!=""&g.artQuality=="extreme"){k=3}if(e.image){f=true;var h=c(e.image[k]["#text"]);if(e.image[k]["#text"]==""){f=false}}var i=c(e.url);var l=e["name"].replace(/"/g,"");var m=e.artist["name"].replace(/"/g,"");j.append('<li class="jmc_track">'+'<a href="'+i+'" title="'+l+" by "+m+'"'+(g._blankLinks?'target="_blank"':'target="_self"')+">"+'<span class="jmc_album_art">'+'<img src="'+(f==true?h:g.noAlbumArtImg)+'" alt="'+l+" by "+m+'" />'+"</span>"+'<span class="jmc_vinyl_case"></span><span class="jmc_vinyl_slip"></span><span class="jmc_vinyl"></span>'+"</a>"+"</li>");if(b==g.number-1){g.onComplete.call(this)}});if(g.tooltips){var f=j;b(f)}}else{j.append('<span class="jmc_message">'+g.noLovedTracks+"</span>");d("No loved tracks...")}}else if(h=="topTracks"){if(e.toptracks.track){if(a.isArray(e.toptracks.track)){}else{e.toptracks.track=[e.toptracks.track]}a.each(e.toptracks.track,function(b,e){if(b>g.number-1)return false;var f=false;if(a(this).attr("error")){a(this).html("An error has occurred");d(a(this).attr("message"))}if(g.artQuality!=""&g.artQuality=="high"){k=2}else if(g.artQuality!=""&g.artQuality=="extreme"){k=3}if(e.image){f=true;var h=c(e.image[k]["#text"]);if(e.image[k]["#text"]==""){f=false}}var i=c(e.url);var l=e["name"].replace(/"/g,"");var m=e.artist["name"].replace(/"/g,"");j.append('<li class="jmc_track">'+'<a href="'+i+'" title="'+l+" by "+m+'"'+(g._blankLinks?'target="_blank"':'target="_self"')+">"+'<span class="jmc_album_art">'+'<img src="'+(f==true?h:g.noAlbumArtImg)+'" alt="'+l+" by "+m+'" />'+"</span>"+'<span class="jmc_vinyl_case"></span><span class="jmc_vinyl_slip"></span><span class="jmc_vinyl"></span>'+"</a>"+"</li>");if(b==g.number-1){g.onComplete.call(this)}});if(g.tooltips){var f=j;b(f)}}else{j.append('<span class="jmc_message">'+g.noLovedTracks+"</span>");d("No loved tracks...")}}else if(h=="newReleases"){if(e.albums.album){if(a.isArray(e.albums.album)){}else{e.albums.album=[e.albums.album]}a.each(e.albums.album,function(b,e){if(b>g.number-1)return false;var f=false;if(a(this).attr("error")){a(this).html("An error has occurred");d(a(this).attr("message"))}if(g.artQuality!=""&g.artQuality=="high"){k=2}else if(g.artQuality!=""&g.artQuality=="extreme"){k=3}if(e.image){f=true;var h=c(e.image[k]["#text"]);if(e.image[k]["#text"]==""){f=false}}var i=c(e.url);var l=e["name"].replace(/"/g,"");var m=e.artist["name"].replace(/"/g,"");j.append('<li class="jmc_track">'+'<a href="'+i+'" title="'+l+" by "+m+'"'+(g._blankLinks?'target="_blank"':'target="_self"')+">"+'<span class="jmc_album_art">'+'<img src="'+(f==true?h:g.noAlbumArtImg)+'" alt="'+l+" by "+m+'" />'+"</span>"+'<span class="jmc_vinyl_case"></span><span class="jmc_vinyl_slip"></span><span class="jmc_vinyl"></span>'+"</a>"+"</li>");if(b==g.number-1){g.onComplete.call(this)}});if(g.tooltips){var f=j;b(f)}}else{j.append('<span class="jmc_message">'+g.noLovedTracks+"</span>");d("No loved tracks...")}}else{if(e.recenttracks.track){if(a.isArray(e.recenttracks.track)){}else{e.recenttracks.track=[e.recenttracks.track]}a.each(e.recenttracks.track,function(b,e){if(b>g.number-1)return false;var f,h=false;if(a(this).attr("error")){a(this).html("An error has occurred");d(a(this).attr("message"))}if(g.artQuality!=""&g.artQuality=="high"){k=2}else if(g.artQuality!=""&g.artQuality=="extreme"){k=3}if(e.image){h=true;var i=c(e.image[k]["#text"]);if(e.image[k]["#text"]==""){h=false}}if(a(this).attr("@attr")){f=true}var l=c(e.url);var m=e["name"].replace(/"/g,"");var n=e.artist["#text"].replace(/"/g,"");j.append('<li class="jmc_track'+(f==true?" jmc_nowplaying":"")+'">'+'<a href="'+l+'" title="'+m+" by "+n+'"'+(g._blankLinks?'target="_blank"':'target="_self"')+">"+(f==true&g.nowPlayingIcon==true?'<span class="jmc_nowplaying"></span>':"")+'<span class="jmc_album_art">'+'<img src="'+(h==true?i:g.noAlbumArtImg)+'" alt="'+m+" by "+n+'" />'+"</span>"+'<span class="jmc_vinyl_case"></span><span class="jmc_vinyl_slip"></span><span class="jmc_vinyl"></span>'+"</a>"+"</li>");if(b==g.number-1){g.onComplete.call(this)}});if(g.tooltips){var f=j;b(f)}}else{j.append('<span class="jmc_message">'+g.noLovedTracks+"</span>");d("No loved tracks...")}}})}})(jQuery)